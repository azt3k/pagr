;(function($,e,a,t){"use strict";var i="pagr",r={loadingSelector:"html",pageLinkSelector:".page-link",pager:{"class":"page-link",next:true,prev:true,range:3,first:true,last:true},forceFilter:false,ajax:false,method:"get",behaviour:"replace",direction:"asc",vars:{page:"page",pageSize:"page_size"},baseURL:e.location.href,pageSize:10,urlHandler:null,ajaxHandler:null,onBeforePage:null,onAfterPage:null};function n(e,a,t,i){this.$element=$(e);this.idx=a;this.selector=t;this.settings=$.extend(true,{},r,i);this.init()}n.prototype={init:function(){var e=this.$element,a=this.settings,t=e.attr("id");e.addClass("pagr");if(!t){while(!t||$("#"+t).length){t=Math.floor(Math.random()*1e3)+1}e.attr("id",t)}if(e.attr("data-size"))a.pageSize=parseInt(e.attr("data-size"));if(["get","post"].indexOf(a.method)==-1)throw"invalid request method supplied";if(["append","replace"].indexOf(a.behaviour)==-1)throw"invalid behaviour supplied";this.attachPagination();if(!a.ajax||a.forceFilter){this.filter()}},attachPagination:function(){var e=this.$element,a,t,i=this,r,n=e.attr("data-page")?parseInt(e.attr("data-page")):1,l=this.settings,s=e.attr("id");if(l.pager){a=this.getContainer();t=$("#"+s+"-wrap");if(t.length)t.replaceWith(i.buildPager(n));else a.after(this.buildPager(n))}$(l.pageLinkSelector).each(function(a){var t=$(this);t.off("tap.pagr, click.pagr").on("tap.pagr, click.pagr",function(a){var r=l.baseURL,n=i.currentPage(),s=t.attr("data-page")?t.attr("data-page"):1,p=l.pageSize,f=i.getTotal(),g=Math.ceil(f/p),o={},d;a.preventDefault();if(typeof l.onBeforePage=="function")l.onBeforePage();switch(s){case"first":d=1;break;case"next":d=n+1>g?g:n+1;break;case"prev":d=n-1<1?1:n-1;break;case"last":d=g;break;default:d=parseInt(s)}if(l.ajax){o[l.vars.page]=d;o[l.vars.pageSize]=p;r=typeof l.urlHandler=="function"?l.urlHandler(o,r):$.qs(o,r);$[l.method](r,function(a,t,r){if(typeof l.ajaxHandler=="function"){l.ajaxHandler(a,t,r)}else{var n=$($(a).find(i.selector)[i.idx]);if(l.behaviour=="append"){e.append(n.children())}else{e.html("").append(n.children())}}e.attr("data-page",d);if(l.forceFilter)i.filter();i.attachPagination()})}else{e.attr("data-page",d);i.filter();i.attachPagination()}if(typeof l.onAfterPage=="function")l.onAfterPage()})})},getTotal:function(){var e=this.$element;return e.attr("data-total")?parseInt(e.attr("data-total")):e.children().length},currentPage:function(){var e=this.$element;return e.attr("data-page")?parseInt(e.attr("data-page")):1},getContainer:function(){var e=this.$element;while(e.parent().is("table, tbody, tr")){e=e.parent()}return e},buildPager:function(e){var a,i,r="",n=this.settings,l=this.$element,s=l.attr("id"),p=l.attr("data-total")?parseInt(l.attr("data-total")):l.children().length,f=n.pager.class!=t&&n.pager.class?n.pager.class:"page-link",g=Math.ceil(p/n.pageSize);r='<div id="'+s+'-wrap" class="pagr-wrap">'+(n.pager.first?'<a class="'+f+'" data-page="first">First</a>':"")+(n.pager.prev?'<a class="'+f+'" data-page="prev">Prev</a>':"");if(n.pager.range){for(i=-n.pager.range;i<=n.pager.range;i++){a=e+i;if(a>0&&a<=g)r+='<a class="'+f+(e==a?" current":"")+'" data-page="'+a+'">'+a+"</a>"}}r+=(n.pager.next?'<a class="'+f+'" data-page="next">Next</a>':"")+(n.pager.last?'<a class="'+f+'" data-page="last">Last</a>':"")+"</div>";return r},filter:function(){var e=this.$element,a=this.settings,t=this.getTotal(),i=this.currentPage();if(t>a.pageSize){e.children().each(function(e){var t=$(this);if(a.behaviour!="append"){if(e>=a.pageSize*(i-1)&&e<a.pageSize*i)t.show();else t.hide()}else{if(e<a.pageSize*i)t.show();else t.hide()}})}}};$.q=function(a,t,i){if(!i)i=e.location.href;var r=new RegExp("([?&])"+a+"=.*?(&|#|$)(.*)","gi"),n;if(r.test(i)){if(typeof t!=="undefined"&&t!==null)return i.replace(r,"$1"+a+"="+t+"$2$3");else{n=i.split("#");i=n[0].replace(r,"$1$3").replace(/(&|\?)$/,"");if(typeof n[1]!=="undefined"&&n[1]!==null)i+="#"+n[1];return i}}else{if(typeof t!=="undefined"&&t!==null){var l=i.indexOf("?")!==-1?"&":"?";n=i.split("#");i=n[0]+l+a+"="+t;if(typeof n[1]!=="undefined"&&n[1]!==null)i+="#"+n[1];return i}else return i}};$.qs=function(e,a){for(var t in e){a=$.q(t,e[t],a)}return a};$.fn[i]=function(e){var a=this.selector;return this.each(function(t){if(!$.data(this,"plugin_"+i)){$.data(this,"plugin_"+i,new n(this,t,a,e))}})}})(jQuery,window,document);
