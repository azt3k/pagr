;(function(e,t){if(typeof define==="function"&&define.amd)define(["jquery"],t);else if(typeof exports==="object")module.exports=t(require("jquery"));else{t(e.jQuery)}})(this,function(C,$){"use strict";C(function(){var r="pagr",e="0.6.1",i={bindTo:"tap click change",loadingSelector:"html",loadingClass:"loading",pageLinkSelector:".page-link",disabledClass:"disabled",filterFormSelector:null,pager:{class:"page-link",next:true,prev:true,range:3,first:true,last:true},forceFilter:false,ajax:false,method:"get",behaviour:"replace",vars:{sortDirection:"direction",sortBy:"sort",page:"page",pageSize:"page_size"},baseURL:window.location.href,pageSize:10,ajaxWait:0,urlHandler:null,requestNotifier:null,ajaxHandler:null,onInit:null,onBeforePage:null,onAfterPage:null};function n(e,t,a,r){this.$element=C(e);this.idx=t;this.settings=C.extend(true,{},i,r);this.selector=a||this.settings.selector;if(!this.selector||this.selector==$)throw"selector option must be supplied in jQuery 3+";this.init()}n.prototype={init:function(){var e=this.$element,t=this.settings,a=e.attr("id");e.addClass("pagr");if(!a){while(!a||C("#"+a).length){a=Math.floor(Math.random()*1e3)+1}e.attr("id",a)}if(["get","post"].indexOf(t.method)==-1)throw"invalid request method supplied";if(["append","replace"].indexOf(t.behaviour)==-1)throw"invalid behaviour supplied";this.attachPagination();if(!t.ajax||t.forceFilter){this.filter()}},attachPagination:function(){var x=this.$element,e,t,y=this,a,r=x.attr("data-page")?parseInt(x.attr("data-page")):1,P=this.settings,i=x.attr("id");if(P.pager){e=this.getContainer();t=C("#"+i+"-wrap");if(t.length)t.replaceWith(y.buildPager(r));else e.after(this.buildPager(r))}C(P.pageLinkSelector).each(function(e){var b=C(this),m=this,t=b.attr("data-bind-to")||P.bindTo,a=t.split(/[ ]+/).map(function(e){return e+".pagr"}).join(" "),r=y.currentPage(),i=b.attr("data-page")?b.attr("data-page"):1,n=y.getMax(),s=y.parsePageJump(i,r,n);b.toggleClass(P.disabledClass,(r>=n||n==0)&&i=="next");b.off(a).on(a,function(n){var e=b.attr("data-allow-default");if(e==$||!e||e=="false")n.preventDefault();if(b.is("."+P.disabledClass))return;if(typeof P.onBeforePage=="function")P.onBeforePage.call(m,y,n);var s=y.baseURL(),t=y.currentPage(),a=b.attr("data-page")?b.attr("data-page"):1,l=y.pageSize(),o=y.sortDirection(),f=y.sortBy(),r=y.getTotal(),i=y.getMax(),d={},p={},u,g,c,h,v;if(!C(P.loadingSelector).is("."+P.loadingClass)){C(P.loadingSelector).addClass(P.loadingClass);u=y.parsePageJump(a,t,i);if(P.ajax){setTimeout(function(){var e=x.attr("data-var-page")||P.vars.page,t=x.attr("data-var-page-size")||P.vars.pageSize,a=x.attr("data-var-sort-by")||P.vars.sortBy,r=x.attr("data-var-sort-direction")||P.vars.sortDirection;d[e]=u;d[t]=l;d[a]=f;d[r]=o;if(g=y.filterForm()){p=C.q2obj(g.serialize());C.extend(d,p)}var i=typeof P.urlHandler=="function"?P.urlHandler(d,s):C.qs(d,s);if(typeof P.requestNotifier=="function")P.requestNotifier(y,i,d,s);C[P.method](i,function(e,t,a){if(typeof P.ajaxHandler=="function"){P.ajaxHandler(y,e,t,a)}else{var r,i=C(C(e).find(y.selector)[y.idx]),r=i.attr("data-total")||0;x.attr("data-total",r);if(P.behaviour=="append"&&u!=1){x.append(i.children())}else{x.html("").append(i.children())}}x.attr("data-page",u);if(P.forceFilter)y.filter();y.attachPagination();if(typeof P.onAfterPage=="function")P.onAfterPage.call(m,y,n);C(P.loadingSelector).removeClass(P.loadingClass)})},P.ajaxWait)}else{x.attr("data-page",u);y.filter();y.attachPagination();if(typeof P.onAfterPage=="function")P.onAfterPage.call(m,y,n);C(P.loadingSelector).removeClass(P.loadingClass)}}})});if(typeof P.onInit=="function")P.onInit.call(x[0],this)},parsePageJump:function(e,t,a){var r;switch(e){case"first":r=1;break;case"next":r=t+1>a?a:t+1;break;case"prev":r=t-1<1?1:t-1;break;case"last":r=a;break;default:r=parseInt(e)}return r},getMax:function(){return Math.ceil(this.getTotal()/this.pageSize())},appendedTotal:function(){var e=this.$element;return e.children().length},getTotal:function(){var e=this.$element;return e.attr("data-total")?parseInt(e.attr("data-total")):e.children().length},currentPage:function(){var e=this.$element;return e.attr("data-page")?parseInt(e.attr("data-page")):1},sortBy:function(){var e=this.$element;return e.attr("data-sort-by")?e.attr("data-sort-by"):null},sortDirection:function(){var e=this.$element;return e.attr("data-sort-direction")=="desc"?"desc":"asc"},baseURL:function(){var e=this.$element,t=this.settings,a=e.attr("data-base-url"),r;if(!a&&e.parent().is("table")){a=e.parent().attr("data-base-url")}r=a?a:t.baseUrl;return r?r:window.location.href},pageSize:function(){var e=this.$element,t=this.settings;return e.attr("data-page-size")?parseInt(e.attr("data-page-size")):t.pageSize},filterForm:function(){var e=this.$element,t=this.settings,a=t.filterFormSelector?C(t.filterFormSelector):null;return e.attr("data-filter-form")?C(e.attr("data-filter-form")):a},getContainer:function(){var e=this.$element;while(e.parent().is("table, tbody, tr")){e=e.parent()}return e},buildPager:function(e){var t,a,r="",i=this.settings,n=this.$element,s=n.attr("id"),l=this.getTotal(),o=i.pager.class!=$&&i.pager.class?i.pager.class:"page-link",f=this.getMax();r='<div id="'+s+'-wrap" class="pagr-wrap">'+(i.pager.first?'<a class="'+o+(e==1?" "+i.disabledClass:"")+'" data-page="first">First</a>':"")+(i.pager.prev?'<a class="'+o+(e==1?" "+i.disabledClass:"")+'" data-page="prev">Prev</a>':"");if(i.pager.range){for(a=-i.pager.range;a<=i.pager.range;a++){t=e+a;if(t>0&&t<=f)r+='<a class="'+o+(e==t?" current":"")+'" data-page="'+t+'">'+t+"</a>"}}r+=(i.pager.next?'<a class="'+o+(e==f?" "+i.disabledClass:"")+'" data-page="next">Next</a>':"")+(i.pager.last?'<a class="'+o+(e==f?" "+i.disabledClass:"")+'" data-page="last">Last</a>':"")+"</div>";return r},filter:function(){var e=this.$element,a=this.settings,t=this.getTotal(),r=this.currentPage(),i=this.pageSize();if(t>i){e.children().each(function(e){var t=C(this);if(a.behaviour!="append"){if(e>=i*(r-1)&&e<i*r)t.show();else t.hide()}else{if(e<i*r)t.show();else t.hide()}})}}};C.q2obj=function(e){if(e=="")return null;var t={},a=e.split("&");for(var r=0;r<a.length;r++){var i=a[r].split("="),n=decodeURIComponent(i[0]),s=decodeURIComponent(i[1]);if(typeof t[n]==="undefined"){if(n.substr(n.length-2)!="[]")t[n]=s;else t[n]=[s]}else if(typeof t[n]==="string")t[n]=s;else t[n].push(s)}return t};C.q=function(e,t,a){if(!a)a=window.location.href;var r=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi"),i;if(r.test(a)){if(typeof t!=="undefined"&&t!==null)return a.replace(r,"$1"+e+"="+t+"$2$3");else{i=a.split("#");a=i[0].replace(r,"$1$3").replace(/(&|\?)$/,"");if(typeof i[1]!=="undefined"&&i[1]!==null)a+="#"+i[1];return a}}else{if(typeof t!=="undefined"&&t!==null){var n=a.indexOf("?")!==-1?"&":"?";i=a.split("#");a=i[0]+n+e+"="+t;if(typeof i[1]!=="undefined"&&i[1]!==null)a+="#"+i[1];return a}else return a}};C.qs=function(e,t,a){a=a||false;var r=t.split("?")[0]||t,i=t.split("?")[1]||"",n=C.q2obj(i),s=a?C.extend(true,{},n,e):C.extend({},n,e);return r+"?"+C.param(s)};C.fn[r]=function(t){var a=this.selector;return this.each(function(e){if(!C.data(this,"plugin_"+r)){C.data(this,"plugin_"+r,new n(this,e,a,t))}})}})});
